<?xml version="1.0" ?>
<!-- MuJoCo model for dual2 - converted from URDF with correct assembly -->
<mujoco model="dual2">
  <compiler angle="radian" meshdir="../assets/parts"/>
  
  <option timestep="0.002" iterations="50" solver="Newton" tolerance="1e-10" gravity="0 0 -9.81"/>
  
  <default>
    <joint armature="0.01" damping="0.5" limited="true"/>
    <geom friction="1.5 0.8 0.02" condim="4" conaffinity="1" contype="1"/>
    <position kp="50" kv="5"/>
  </default>

  <asset>
    <mesh name="socket_button_head_screw_m3x0_5_x_5__3d0b7d67b03d7dab03d7e71c432bce35" file="socket_button_head_screw_m3x0_5_x_5__3d0b7d67b03d7dab03d7e71c432bce35.stl"/>
    <mesh name="sts3215_servo" file="sts3215_servo.stl"/>
    <mesh name="driven_horn" file="driven_horn.stl"/>
    <mesh name="passive_horn" file="passive_horn.stl"/>
    <mesh name="so_arm100_08k_116_square" file="so_arm100_08k_116_square.stl"/>
    <mesh name="so_arm100_08k_mirror" file="so_arm100_08k_mirror.stl"/>
    <mesh name="so_arm100_08k_mirror__2" file="so_arm100_08k_mirror__2.stl"/>
    <mesh name="wrist_roll_pitch_08i" file="wrist_roll_pitch_08i.stl"/>
    <mesh name="wrist_roll_08c" file="wrist_roll_08c.stl"/>
    <mesh name="moving_jaw_08d" file="moving_jaw_08d.stl"/>
    
    <!-- Materials -->
    <material name="green" rgba="0.329 0.788 0.114 1" specular="0.5" shininess="0.3"/>
    <material name="dark_gray" rgba="0.302 0.302 0.302 1" specular="0.3" shininess="0.1"/>
    <material name="white" rgba="0.918 0.918 0.918 1" specular="0.4" shininess="0.2"/>
    <material name="silver" rgba="0.604 0.647 0.686 1" specular="0.8" shininess="0.5"/>
    
    <!-- Floor texture -->
    <texture name="grid" type="2d" builtin="checker" width="512" height="512" rgb1="0.15 0.15 0.15" rgb2="0.25 0.25 0.25"/>
    <material name="grid_mat" texture="grid" texrepeat="10 10" reflectance="0.1"/>
  </asset>

  <worldbody>
    <!-- Ground plane -->
    <geom name="floor" type="plane" size="2 2 0.1" material="grid_mat"/>
    
    <!-- Lighting -->
    <light directional="true" diffuse="0.9 0.9 0.9" specular="0.3 0.3 0.3" pos="0 0 5" dir="0 0 -1"/>
    <light directional="true" diffuse="0.4 0.4 0.4" specular="0.2 0.2 0.2" pos="1 2 3" dir="-0.3 -0.5 -1"/>
    
    <!-- ==================== BASE BODY ==================== -->
    <!-- st3215_servo_phosphobot - the central hub with both servos -->
    <!-- Robot grips wall1 top with arm1 gripper using friction only -->
    <!-- Wall1 top at (0.15, 0, 0.30), position base so gripper reaches it -->
    <body name="base" pos="0.0 0 0.35">
      <freejoint name="root"/>
      <inertial pos="-0.0403 -0.0907 0.1008" mass="0.082" diaginertia="4.6e-5 4.2e-5 5.2e-5"/>
      
      <!-- Base servo parts (arm1 side) -->
      <geom pos="-0.0751771 -0.100049 0.0826237" quat="0.10723 0.45295 -0.54299 -0.698928" type="mesh" material="silver" mesh="socket_button_head_screw_m3x0_5_x_5__3d0b7d67b03d7dab03d7e71c432bce35"/>
      <geom pos="-0.0528391 -0.105496 0.0890825" quat="0.396108 0.24446 0.110267 -0.878168" type="mesh" material="dark_gray" mesh="sts3215_servo"/>
      <geom pos="-0.0528391 -0.105496 0.0890825" quat="0.396108 0.24446 0.110267 -0.878168" type="mesh" material="white" mesh="driven_horn"/>
      <geom pos="-0.0466544 -0.125234 0.0826237" quat="0.396108 0.24446 0.110267 -0.878168" type="mesh" material="white" mesh="passive_horn"/>
      
      <!-- Base servo parts (arm2 side) -->
      <geom pos="-0.00676049 -0.0800519 0.119" quat="-0.110266 0.878168 0.396108 0.244461" type="mesh" material="white" mesh="passive_horn"/>
      <geom pos="-0.0352832 -0.0548674 0.119" quat="0.698928 -0.542989 -0.452951 0.107231" type="mesh" material="silver" mesh="socket_button_head_screw_m3x0_5_x_5__3d0b7d67b03d7dab03d7e71c432bce35"/>
      <geom pos="-0.027112 -0.076359 0.112541" quat="-0.110266 0.878168 0.396108 0.244461" type="mesh" material="dark_gray" mesh="sts3215_servo"/>
      <geom pos="-0.027112 -0.076359 0.112541" quat="-0.110266 0.878168 0.396108 0.244461" type="mesh" material="white" mesh="driven_horn"/>
      
      <!-- ==================== ARM 1 (longer arm) ==================== -->
      <body name="arm1_link1" pos="-0.0340463 -0.0559595 0.119" quat="0.694354 0.359369 0.608978 -0.133685">
        <inertial pos="-0.0692389 -0.00301229 0.0197206" quat="0.475865 0.474137 0.522165 0.525443" mass="0.198604" diaginertia="0.00036564 0.000313285 9.33286e-05"/>
        <joint name="arm1_shoulder" pos="0 0 0" axis="0 0 1" range="-2.94151 0.200086"/>
        
        <geom pos="-0.065085 0.012 0.0197" quat="0.707105 0.707108 0 0" type="mesh" material="green" mesh="so_arm100_08k_116_square"/>
        <geom pos="-0.11257 -0.028 0.0379" quat="0.499998 0.5 -0.500002 -0.5" type="mesh" material="white" mesh="passive_horn"/>
        <geom pos="-0.11257 -0.028 -0.00015" quat="9.38184e-07 -0.707105 0.707108 -9.38188e-07" type="mesh" material="silver" mesh="socket_button_head_screw_m3x0_5_x_5__3d0b7d67b03d7dab03d7e71c432bce35"/>
        <geom pos="-0.11257 -0.0155 0.0202" quat="0.499998 0.5 -0.500002 -0.5" type="mesh" material="dark_gray" mesh="sts3215_servo"/>
        <geom pos="-0.11257 -0.0155 0.0202" quat="0.499998 0.5 -0.500002 -0.5" type="mesh" material="white" mesh="driven_horn"/>
        
        <body name="arm1_link2" pos="-0.11257 -0.028 0.0015" quat="1 0 0 3.01201e-09">
          <inertial pos="-0.0758873 0.0012846 0.0147496" quat="0.477269 0.542047 0.516114 0.460463" mass="0.18055" diaginertia="0.000327255 0.000287952 6.19217e-05"/>
          <joint name="arm1_elbow" pos="0 0 0" axis="0 0 1" range="0 3.14159"/>
          
          <geom pos="-0.0648499 -0.032 0.0182" quat="0.707105 0.707108 0 0" type="mesh" material="green" mesh="so_arm100_08k_mirror"/>
          <geom pos="-0.0648499 -0.032 0.0184" quat="0.707105 0.707108 0 0" type="mesh" material="green" mesh="so_arm100_08k_mirror__2"/>
          <geom pos="-0.1349 0.0052 0.0363" quat="9.38184e-07 9.38187e-07 -0.707108 -0.707105" type="mesh" material="white" mesh="passive_horn"/>
          <geom pos="-0.1349 0.0052 -0.00175" quat="2.17347e-12 -1.32679e-06 -1 1.32679e-06" type="mesh" material="silver" mesh="socket_button_head_screw_m3x0_5_x_5__3d0b7d67b03d7dab03d7e71c432bce35"/>
          <geom pos="-0.1224 0.0052 0.0186" quat="9.38184e-07 9.38187e-07 -0.707108 -0.707105" type="mesh" material="dark_gray" mesh="sts3215_servo"/>
          <geom pos="-0.1224 0.0052 0.0186" quat="9.38184e-07 9.38187e-07 -0.707108 -0.707105" type="mesh" material="white" mesh="driven_horn"/>
          
          <body name="arm1_wrist_pitch" pos="-0.1349 0.0052 -0.0001" quat="0.664778 0 0 -0.747041">
            <inertial pos="0.0348768 2.4895e-05 0.0103283" quat="0.659112 -0.259442 -0.258434 0.656866" mass="0.0789518" diaginertia="4.97311e-05 3.37971e-05 2.6432e-05"/>
            <joint name="arm1_wrist_pitch" pos="0 0 0" axis="0 0 1" range="-3.02519 0.116402"/>
            
            <geom pos="0.028 0 0.0181" quat="0.499998 0.5 0.5 -0.500002" type="mesh" material="green" mesh="wrist_roll_pitch_08i"/>
            <geom pos="0.0247 0 0.0181" quat="0.499998 0.5 -0.5 0.500002" type="mesh" material="white" mesh="passive_horn"/>
            <geom pos="0.06275 0 0.0181" quat="9.38184e-07 -0.707105 -9.38187e-07 -0.707108" type="mesh" material="silver" mesh="socket_button_head_screw_m3x0_5_x_5__3d0b7d67b03d7dab03d7e71c432bce35"/>
            <geom pos="0.0424 0 0.0056" quat="0.499998 0.5 -0.5 0.500002" type="mesh" material="dark_gray" mesh="sts3215_servo"/>
            <geom pos="0.0424 0 0.0056" quat="0.499998 0.5 -0.5 0.500002" type="mesh" material="white" mesh="driven_horn"/>
            
            <body name="arm1_wrist_roll" pos="0.0611 0 0.0181" quat="0.65593 0.264111 -0.655932 -0.264111">
              <inertial pos="-0.00588121 0.000485423 -0.0272358" quat="0.649924 0.235394 0.235171 0.683289" mass="0.112045" diaginertia="7.48277e-05 6.46447e-05 3.99649e-05"/>
              <joint name="arm1_wrist_roll" pos="0 0 0" axis="0 0 1" range="-0.805218 2.33638"/>
              
              <geom quat="0.707105 0.707108 0 0" type="mesh" material="green" mesh="wrist_roll_08c"/>
              <geom pos="0.0198 -0.0178 -0.023625" quat="1.32679e-06 1 0 0" type="mesh" material="white" mesh="passive_horn"/>
              <geom pos="0.0198 0.02025 -0.023625" quat="0.707105 -0.707108 0 0" type="mesh" material="silver" mesh="socket_button_head_screw_m3x0_5_x_5__3d0b7d67b03d7dab03d7e71c432bce35"/>
              <geom pos="0.0073 -0.0001 -0.023625" quat="1.32679e-06 1 0 0" type="mesh" material="dark_gray" mesh="sts3215_servo"/>
              <geom pos="0.0073 -0.0001 -0.023625" quat="1.32679e-06 1 0 0" type="mesh" material="white" mesh="driven_horn"/>
              
              <body name="arm1_gripper" pos="0.0198 0.0186 -0.023625" quat="0.525396 0.525398 -0.473241 0.473243">
                <inertial pos="-0.00739035 -0.0295297 0.0192843" quat="0.689904 0.712368 -0.0928179 -0.0891538" mass="0.0252688" diaginertia="1.38563e-05 1.12152e-05 3.72291e-06"/>
                <joint name="arm1_gripper" pos="0 0 0" axis="0 0 1" range="-1.46644 0.104359"/>
                
                <geom pos="0 0 0.0189" quat="0.70385 -0.703853 0.0677732 -0.067773" type="mesh" material="green" mesh="moving_jaw_08d"/>
                <site name="arm1_tip" pos="0 -0.045 0.02" size="0.006" rgba="1 0.3 0 0.8"/>
              </body>
            </body>
          </body>
        </body>
      </body>
      
      <!-- ==================== ARM 2 (shorter arm) ==================== -->
      <body name="arm2_wrist_pitch" pos="-0.0739402 -0.101141 0.0826237" quat="0.510736 -0.0285358 0.706532 -0.489027">
        <inertial pos="0.0348768 2.4895e-05 0.0103283" quat="0.659112 -0.259442 -0.258434 0.656866" mass="0.0789518" diaginertia="4.97311e-05 3.37971e-05 2.6432e-05"/>
        <joint name="arm2_shoulder" pos="0 0 0" axis="0 0 1" range="-1.79454 1.34706"/>
        
        <geom pos="0.0247 0 0.0181" quat="0.499998 0.5 -0.5 0.500002" type="mesh" material="white" mesh="passive_horn"/>
        <geom pos="0.06275 0 0.0181" quat="9.38184e-07 -0.707105 -9.38187e-07 -0.707108" type="mesh" material="silver" mesh="socket_button_head_screw_m3x0_5_x_5__3d0b7d67b03d7dab03d7e71c432bce35"/>
        <geom pos="0.0424 0 0.0056" quat="0.499998 0.5 -0.5 0.500002" type="mesh" material="white" mesh="driven_horn"/>
        <geom pos="0.0424 0 0.0056" quat="0.499998 0.5 -0.5 0.500002" type="mesh" material="dark_gray" mesh="sts3215_servo"/>
        <geom pos="0.028 0 0.0181" quat="0.499998 0.5 0.5 -0.500002" type="mesh" material="green" mesh="wrist_roll_pitch_08i"/>
        
        <body name="arm2_wrist_roll" pos="0.0611 0 0.0181" quat="0.499998 0.5 -0.500002 -0.5">
          <inertial pos="-0.00588121 0.000485423 -0.0272358" quat="0.649924 0.235394 0.235171 0.683289" mass="0.112045" diaginertia="7.48277e-05 6.46447e-05 3.99649e-05"/>
          <joint name="arm2_wrist_roll" pos="0 0 0" axis="0 0 1" range="0 3.14159"/>
          
          <geom pos="0.0073 -0.0001 -0.023625" quat="1.32679e-06 1 0 0" type="mesh" material="white" mesh="driven_horn"/>
          <geom pos="0.0073 -0.0001 -0.023625" quat="1.32679e-06 1 0 0" type="mesh" material="dark_gray" mesh="sts3215_servo"/>
          <geom quat="0.707105 0.707108 0 0" type="mesh" material="green" mesh="wrist_roll_08c"/>
          <geom pos="0.0198 0.02025 -0.023625" quat="0.707105 -0.707108 0 0" type="mesh" material="silver" mesh="socket_button_head_screw_m3x0_5_x_5__3d0b7d67b03d7dab03d7e71c432bce35"/>
          <geom pos="0.0198 -0.0178 -0.023625" quat="1.32679e-06 1 0 0" type="mesh" material="white" mesh="passive_horn"/>
          
          <body name="arm2_gripper" pos="0.0198 0.0186 -0.023625" quat="0.644246 0.644248 -0.291454 0.291455">
            <inertial pos="-0.00739035 -0.0295297 0.0192843" quat="0.689904 0.712368 -0.0928179 -0.0891538" mass="0.0252688" diaginertia="1.38563e-05 1.12152e-05 3.72291e-06"/>
            <joint name="arm2_gripper" pos="0 0 0" axis="0 0 1" range="-0.849688 0.721109"/>
            
            <geom pos="0 0 0.0189" quat="0.70385 -0.703853 0.0677732 -0.067773" type="mesh" material="green" mesh="moving_jaw_08d"/>
            <site name="arm2_tip" pos="0 -0.045 0.02" size="0.006" rgba="1 0.3 0 0.8"/>
          </body>
        </body>
      </body>
    </body>
    
    <!-- ==================== WALL OBSTACLES ==================== -->
    <!-- 10 walls: 30cm tall, 2cm thick, 15cm apart -->
    <!-- Robot starts at x=-0.1, target at x=1.6 (after all walls) -->
    
    <body name="wall1" pos="0.15 0 0.15">
      <geom name="wall1" type="box" size="0.01 0.15 0.15" rgba="0.6 0.3 0.2 1"/>
      <!-- Grip bar on top of wall - cylindrical bar that gripper can wrap around -->
      <geom name="wall1_bar" type="cylinder" pos="0 0 0.16" size="0.012 0.15" euler="1.5708 0 0" rgba="0.4 0.4 0.4 1" friction="2.0 0.8 0.02"/>
    </body>
    <body name="wall2" pos="0.30 0 0.15">
      <geom name="wall2" type="box" size="0.01 0.15 0.15" rgba="0.6 0.3 0.2 1"/>
    </body>
    <body name="wall3" pos="0.45 0 0.15">
      <geom name="wall3" type="box" size="0.01 0.15 0.15" rgba="0.6 0.3 0.2 1"/>
    </body>
    <body name="wall4" pos="0.60 0 0.15">
      <geom name="wall4" type="box" size="0.01 0.15 0.15" rgba="0.6 0.3 0.2 1"/>
    </body>
    <body name="wall5" pos="0.75 0 0.15">
      <geom name="wall5" type="box" size="0.01 0.15 0.15" rgba="0.6 0.3 0.2 1"/>
    </body>
    <body name="wall6" pos="0.90 0 0.15">
      <geom name="wall6" type="box" size="0.01 0.15 0.15" rgba="0.6 0.3 0.2 1"/>
    </body>
    <body name="wall7" pos="1.05 0 0.15">
      <geom name="wall7" type="box" size="0.01 0.15 0.15" rgba="0.6 0.3 0.2 1"/>
    </body>
    <body name="wall8" pos="1.20 0 0.15">
      <geom name="wall8" type="box" size="0.01 0.15 0.15" rgba="0.6 0.3 0.2 1"/>
    </body>
    <body name="wall9" pos="1.35 0 0.15">
      <geom name="wall9" type="box" size="0.01 0.15 0.15" rgba="0.6 0.3 0.2 1"/>
    </body>
    <body name="wall10" pos="1.50 0 0.15">
      <geom name="wall10" type="box" size="0.01 0.15 0.15" rgba="0.6 0.3 0.2 1"/>
    </body>
    
    <!-- Target marker (goal position after all walls) -->
    <body name="target" pos="1.7 0 0.05">
      <geom name="target" type="cylinder" size="0.08 0.01" rgba="0.2 0.8 0.2 0.8" contype="0" conaffinity="0"/>
      <site name="target_site" pos="0 0 0.02" size="0.05" rgba="0 1 0 0.5"/>
    </body>
  </worldbody>

  <actuator>
    <!-- Arm 1: 5 DOF -->
    <position name="arm1_shoulder_act" joint="arm1_shoulder" kp="100"/>
    <position name="arm1_elbow_act" joint="arm1_elbow" kp="80"/>
    <position name="arm1_wrist_pitch_act" joint="arm1_wrist_pitch" kp="60"/>
    <position name="arm1_wrist_roll_act" joint="arm1_wrist_roll" kp="40"/>
    <position name="arm1_gripper_act" joint="arm1_gripper" kp="100" kv="10"/>
    
    <!-- Arm 2: 3 DOF -->
    <position name="arm2_shoulder_act" joint="arm2_shoulder" kp="80"/>
    <position name="arm2_wrist_roll_act" joint="arm2_wrist_roll" kp="40"/>
    <position name="arm2_gripper_act" joint="arm2_gripper" kp="100" kv="10"/>
  </actuator>

  <sensor>
    <jointpos name="arm1_shoulder_pos" joint="arm1_shoulder"/>
    <jointpos name="arm1_elbow_pos" joint="arm1_elbow"/>
    <jointpos name="arm1_wrist_pitch_pos" joint="arm1_wrist_pitch"/>
    <jointpos name="arm1_wrist_roll_pos" joint="arm1_wrist_roll"/>
    <jointpos name="arm1_gripper_pos" joint="arm1_gripper"/>
    <jointpos name="arm2_shoulder_pos" joint="arm2_shoulder"/>
    <jointpos name="arm2_wrist_roll_pos" joint="arm2_wrist_roll"/>
    <jointpos name="arm2_gripper_pos" joint="arm2_gripper"/>
    
    <framepos name="base_pos" objtype="body" objname="base"/>
    <framequat name="base_quat" objtype="body" objname="base"/>
    
    <touch name="arm1_touch" site="arm1_tip"/>
    <touch name="arm2_touch" site="arm2_tip"/>
  </sensor>

  <contact>
    <exclude body1="base" body2="arm1_link1"/>
    <exclude body1="base" body2="arm2_wrist_pitch"/>
    <exclude body1="arm1_link1" body2="arm1_link2"/>
    <exclude body1="arm1_link2" body2="arm1_wrist_pitch"/>
    <exclude body1="arm1_wrist_pitch" body2="arm1_wrist_roll"/>
    <exclude body1="arm1_wrist_roll" body2="arm1_gripper"/>
    <exclude body1="arm2_wrist_pitch" body2="arm2_wrist_roll"/>
    <exclude body1="arm2_wrist_roll" body2="arm2_gripper"/>
  </contact>

  <!-- Initial pose: robot gripping wall1 top with arm1, holding by friction -->
  <!-- Wall1 top at (0.15, 0, 0.30). Arm1 extends to grip it firmly. -->
  <!-- Joint order: arm1_shoulder, arm1_elbow, arm1_wrist_pitch, arm1_wrist_roll, arm1_gripper, arm2_shoulder, arm2_wrist_roll, arm2_gripper -->
  <!-- Base behind wall, arm reaching forward to grip wall top -->
  <keyframe>
    <key name="hanging" 
         qpos="0.0 0 0.35 1 0 0 0 0.0 2.5 -0.3 0.0 -1.2 0.0 0.5 0.0"
         ctrl="0.0 2.5 -0.3 0.0 -1.2 0.0 0.5 0.0"/>
  </keyframe>
</mujoco>
